# Streamlit UI image with timezone configured
ARG BASE_IMAGE=python:3.13-slim
FROM ${BASE_IMAGE}

ARG TZ=America/Sao_Paulo
ENV TZ=${TZ}
ENV DEBIAN_FRONTEND=noninteractive

RUN apt-get update \
 && apt-get install -y --no-install-recommends tzdata curl \
 && ln -sf /usr/share/zoneinfo/${TZ} /etc/localtime \
 && echo "${TZ}" > /etc/timezone \
 && dpkg-reconfigure -f noninteractive tzdata \
 && rm -rf /var/lib/apt/lists/*

WORKDIR /app

# Copy UI code
COPY ui/ /app/

# Install runtime Python deps (adjust versions as needed)
RUN pip install --no-cache-dir "streamlit>=1.50.0" requests

ENV PYTHONUNBUFFERED=1
ENV STREAMLIT_SERVER_ENABLE_CORS=false
ENV STREAMLIT_SERVER_HEADLESS=true
ENV STREAMLIT_SERVER_PORT=8501

EXPOSE 8501

CMD ["streamlit", "run", "streamlit_app.py", "--server.port", "8501", "--server.address", "0.0.0.0"]
